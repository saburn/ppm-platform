<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Tracking - Analytics & Insights</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .chart-container {
            position: relative;
            height: 280px;
            margin-bottom: 20px;
        }
        .heat-cell {
            transition: all 0.2s;
            cursor: pointer;
        }
        .heat-cell:hover {
            transform: scale(1.1);
            z-index: 10;
        }
        .metric-card {
            transition: all 0.3s;
        }
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body class="bg-gray-50">
    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <!-- Header -->
    <div class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg">
        <div class="max-w-7xl mx-auto px-6 py-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold flex items-center">
                        <i class="fas fa-chart-line mr-3"></i>
                        Time Tracking - Analytics & Insights
                    </h1>
                    <p class="text-purple-100 mt-2">AI-powered analytics with 50% error reduction & 95% billing accuracy</p>
                </div>
                <div class="flex gap-3">
                    <select class="bg-white text-gray-800 px-4 py-2 rounded-lg font-semibold">
                        <option>Last 7 Days</option>
                        <option>Last 30 Days</option>
                        <option>Last Quarter</option>
                        <option>Last Year</option>
                        <option>Custom Range</option>
                    </select>
                    <button class="bg-white text-purple-600 px-6 py-2 rounded-lg font-semibold hover:shadow-lg transition-all">
                        <i class="fas fa-download mr-2"></i>Export Report
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-6 py-8">
        <!-- Key Metrics -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
            <div class="metric-card bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white">
                <div class="flex items-center justify-between mb-4">
                    <div class="bg-white bg-opacity-20 rounded-full p-3">
                        <i class="fas fa-clock text-2xl"></i>
                    </div>
                    <span class="text-sm bg-white bg-opacity-20 px-3 py-1 rounded-full">+12%</span>
                </div>
                <p class="text-blue-100 text-sm font-medium">Total Hours</p>
                <p class="text-3xl font-bold mt-2">168.5h</p>
                <p class="text-blue-100 text-sm mt-1">This month</p>
            </div>
            <div class="metric-card bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white">
                <div class="flex items-center justify-between mb-4">
                    <div class="bg-white bg-opacity-20 rounded-full p-3">
                        <i class="fas fa-dollar-sign text-2xl"></i>
                    </div>
                    <span class="text-sm bg-white bg-opacity-20 px-3 py-1 rounded-full">+8%</span>
                </div>
                <p class="text-green-100 text-sm font-medium">Billable Hours</p>
                <p class="text-3xl font-bold mt-2">152.0h</p>
                <p class="text-green-100 text-sm mt-1">90% of total</p>
            </div>
            <div class="metric-card bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg p-6 text-white">
                <div class="flex items-center justify-between mb-4">
                    <div class="bg-white bg-opacity-20 rounded-full p-3">
                        <i class="fas fa-chart-pie text-2xl"></i>
                    </div>
                    <span class="text-sm bg-white bg-opacity-20 px-3 py-1 rounded-full">+5%</span>
                </div>
                <p class="text-purple-100 text-sm font-medium">Utilization Rate</p>
                <p class="text-3xl font-bold mt-2">87%</p>
                <p class="text-purple-100 text-sm mt-1">Target: 80%</p>
            </div>
            <div class="metric-card bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl shadow-lg p-6 text-white">
                <div class="flex items-center justify-between mb-4">
                    <div class="bg-white bg-opacity-20 rounded-full p-3">
                        <i class="fas fa-exclamation-triangle text-2xl"></i>
                    </div>
                    <span class="text-sm bg-white bg-opacity-20 px-3 py-1 rounded-full">-50%</span>
                </div>
                <p class="text-orange-100 text-sm font-medium">Time Entry Errors</p>
                <p class="text-3xl font-bold mt-2">3</p>
                <p class="text-orange-100 text-sm mt-1">AI detected & fixed</p>
            </div>
        </div>

        <!-- Charts Row 1 -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <!-- Time Distribution by Project -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-bold text-gray-800">Time Distribution by Project</h3>
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
                <div class="chart-container">
                    <canvas id="projectDistributionChart"></canvas>
                </div>
                <div class="grid grid-cols-2 gap-3 mt-4">
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-blue-500"></div>
                        <span class="text-sm text-gray-600">Website Redesign: 45%</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        <span class="text-sm text-gray-600">Mobile App: 28%</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-purple-500"></div>
                        <span class="text-sm text-gray-600">Cloud Migration: 15%</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-orange-500"></div>
                        <span class="text-sm text-gray-600">Internal: 12%</span>
                    </div>
                </div>
            </div>

            <!-- Billable vs Non-Billable -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-bold text-gray-800">Billable vs Non-Billable Hours</h3>
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
                <div class="chart-container">
                    <canvas id="billableChart"></canvas>
                </div>
                <div class="grid grid-cols-3 gap-3 mt-4">
                    <div class="text-center p-3 bg-green-50 rounded-lg">
                        <div class="text-2xl font-bold text-green-600">152h</div>
                        <div class="text-sm text-gray-600">Billable</div>
                    </div>
                    <div class="text-center p-3 bg-orange-50 rounded-lg">
                        <div class="text-2xl font-bold text-orange-600">12h</div>
                        <div class="text-sm text-gray-600">Non-Billable</div>
                    </div>
                    <div class="text-center p-3 bg-blue-50 rounded-lg">
                        <div class="text-2xl font-bold text-blue-600">4.5h</div>
                        <div class="text-sm text-gray-600">Internal</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Row 2 -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <!-- Weekly Utilization Trend -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-bold text-gray-800">Weekly Utilization Trend</h3>
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
                <div class="chart-container">
                    <canvas id="utilizationTrendChart"></canvas>
                </div>
                <div class="flex items-center justify-between mt-4 p-3 bg-purple-50 rounded-lg">
                    <div>
                        <div class="text-sm text-gray-600">Average Utilization</div>
                        <div class="text-2xl font-bold text-purple-600">87%</div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-gray-600">Trend</div>
                        <div class="text-lg font-bold text-green-600">
                            <i class="fas fa-arrow-up mr-1"></i>+5%
                        </div>
                    </div>
                </div>
            </div>

            <!-- Overtime Analysis -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-bold text-gray-800">Overtime Analysis</h3>
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
                <div class="chart-container">
                    <canvas id="overtimeChart"></canvas>
                </div>
                <div class="grid grid-cols-2 gap-3 mt-4">
                    <div class="p-3 bg-orange-50 rounded-lg">
                        <div class="text-sm text-gray-600">Total Overtime</div>
                        <div class="text-2xl font-bold text-orange-600">8.5h</div>
                        <div class="text-xs text-gray-500 mt-1">This month</div>
                    </div>
                    <div class="p-3 bg-red-50 rounded-lg">
                        <div class="text-sm text-gray-600">Peak Week</div>
                        <div class="text-2xl font-bold text-red-600">4.5h</div>
                        <div class="text-xs text-gray-500 mt-1">Week of Dec 11</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Activity Heat Map -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h3 class="text-xl font-bold text-gray-800">Activity Heat Map</h3>
                    <p class="text-sm text-gray-500 mt-1">Time logged by day and hour - darker = more activity</p>
                </div>
                <div class="flex gap-2 items-center">
                    <span class="text-sm text-gray-600">Less</span>
                    <div class="flex gap-1">
                        <div class="w-4 h-4 bg-gray-100 rounded"></div>
                        <div class="w-4 h-4 bg-blue-200 rounded"></div>
                        <div class="w-4 h-4 bg-blue-400 rounded"></div>
                        <div class="w-4 h-4 bg-blue-600 rounded"></div>
                        <div class="w-4 h-4 bg-blue-800 rounded"></div>
                    </div>
                    <span class="text-sm text-gray-600">More</span>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr>
                            <th class="text-left py-2 px-3 text-sm font-semibold text-gray-600">Hour</th>
                            <th class="text-center py-2 px-3 text-sm font-semibold text-gray-600">Mon</th>
                            <th class="text-center py-2 px-3 text-sm font-semibold text-gray-600">Tue</th>
                            <th class="text-center py-2 px-3 text-sm font-semibold text-gray-600">Wed</th>
                            <th class="text-center py-2 px-3 text-sm font-semibold text-gray-600">Thu</th>
                            <th class="text-center py-2 px-3 text-sm font-semibold text-gray-600">Fri</th>
                            <th class="text-center py-2 px-3 text-sm font-semibold text-gray-600">Sat</th>
                            <th class="text-center py-2 px-3 text-sm font-semibold text-gray-600">Sun</th>
                        </tr>
                    </thead>
                    <tbody id="heatMapBody">
                        <!-- Heat map will be generated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Planned vs Actual Comparison -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-800">Planned vs Actual Time</h3>
                <div class="flex gap-3">
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-blue-500"></div>
                        <span class="text-sm text-gray-600">Planned</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        <span class="text-sm text-gray-600">Actual</span>
                    </div>
                </div>
            </div>
            <div class="chart-container" style="height: 300px;">
                <canvas id="plannedVsActualChart"></canvas>
            </div>
            <div class="grid grid-cols-3 gap-4 mt-6">
                <div class="text-center p-4 bg-blue-50 rounded-lg">
                    <div class="text-sm text-gray-600 mb-2">Total Planned</div>
                    <div class="text-3xl font-bold text-blue-600">160h</div>
                </div>
                <div class="text-center p-4 bg-green-50 rounded-lg">
                    <div class="text-sm text-gray-600 mb-2">Total Actual</div>
                    <div class="text-3xl font-bold text-green-600">168.5h</div>
                </div>
                <div class="text-center p-4 bg-orange-50 rounded-lg">
                    <div class="text-sm text-gray-600 mb-2">Variance</div>
                    <div class="text-3xl font-bold text-orange-600">+5.3%</div>
                </div>
            </div>
        </div>

        <!-- Productivity Insights -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl shadow-lg p-6">
                <div class="flex items-center gap-4 mb-4">
                    <div class="bg-blue-500 text-white rounded-full p-4">
                        <i class="fas fa-brain text-2xl"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-gray-800">AI Insights</h4>
                        <p class="text-sm text-gray-600">Smart recommendations</p>
                    </div>
                </div>
                <ul class="space-y-2">
                    <li class="flex items-start gap-2 text-sm text-gray-700">
                        <i class="fas fa-check-circle text-green-500 mt-1"></i>
                        <span>Peak productivity: 10 AM - 12 PM</span>
                    </li>
                    <li class="flex items-start gap-2 text-sm text-gray-700">
                        <i class="fas fa-check-circle text-green-500 mt-1"></i>
                        <span>Consistent 8.5h daily average</span>
                    </li>
                    <li class="flex items-start gap-2 text-sm text-gray-700">
                        <i class="fas fa-exclamation-circle text-orange-500 mt-1"></i>
                        <span>Consider breaks after 4h sessions</span>
                    </li>
                </ul>
            </div>

            <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl shadow-lg p-6">
                <div class="flex items-center gap-4 mb-4">
                    <div class="bg-green-500 text-white rounded-full p-4">
                        <i class="fas fa-trophy text-2xl"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-gray-800">Achievements</h4>
                        <p class="text-sm text-gray-600">This month</p>
                    </div>
                </div>
                <ul class="space-y-2">
                    <li class="flex items-start gap-2 text-sm text-gray-700">
                        <i class="fas fa-star text-yellow-500 mt-1"></i>
                        <span>100% on-time timesheet submission</span>
                    </li>
                    <li class="flex items-start gap-2 text-sm text-gray-700">
                        <i class="fas fa-star text-yellow-500 mt-1"></i>
                        <span>Zero billing errors detected</span>
                    </li>
                    <li class="flex items-start gap-2 text-sm text-gray-700">
                        <i class="fas fa-star text-yellow-500 mt-1"></i>
                        <span>87% utilization (above target)</span>
                    </li>
                </ul>
            </div>

            <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl shadow-lg p-6">
                <div class="flex items-center gap-4 mb-4">
                    <div class="bg-purple-500 text-white rounded-full p-4">
                        <i class="fas fa-lightbulb text-2xl"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-gray-800">Suggestions</h4>
                        <p class="text-sm text-gray-600">Optimize your time</p>
                    </div>
                </div>
                <ul class="space-y-2">
                    <li class="flex items-start gap-2 text-sm text-gray-700">
                        <i class="fas fa-arrow-right text-purple-500 mt-1"></i>
                        <span>Block 2h for deep work daily</span>
                    </li>
                    <li class="flex items-start gap-2 text-sm text-gray-700">
                        <i class="fas fa-arrow-right text-purple-500 mt-1"></i>
                        <span>Reduce meeting time by 15%</span>
                    </li>
                    <li class="flex items-start gap-2 text-sm text-gray-700">
                        <i class="fas fa-arrow-right text-purple-500 mt-1"></i>
                        <span>Use timer for better accuracy</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Toast notification
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `
                <div class="flex items-center gap-3">
                    <i class="fas fa-check-circle text-2xl"></i>
                    <span class="font-semibold">${message}</span>
                </div>
            `;
            document.getElementById('toastContainer').appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // Project Distribution Chart
        const projectCtx = document.getElementById('projectDistributionChart').getContext('2d');
        new Chart(projectCtx, {
            type: 'doughnut',
            data: {
                labels: ['Website Redesign', 'Mobile App', 'Cloud Migration', 'Internal'],
                datasets: [{
                    data: [75.8, 47.2, 25.3, 20.2],
                    backgroundColor: ['#3b82f6', '#10b981', '#8b5cf6', '#f59e0b'],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                }
            }
        });

        // Billable Chart
        const billableCtx = document.getElementById('billableChart').getContext('2d');
        new Chart(billableCtx, {
            type: 'bar',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                datasets: [
                    {
                        label: 'Billable',
                        data: [38, 40, 37, 37],
                        backgroundColor: '#10b981'
                    },
                    {
                        label: 'Non-Billable',
                        data: [3, 2, 4, 3],
                        backgroundColor: '#f59e0b'
                    },
                    {
                        label: 'Internal',
                        data: [1, 1.5, 1, 1],
                        backgroundColor: '#3b82f6'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { stacked: true },
                    y: { stacked: true, beginAtZero: true }
                },
                plugins: {
                    legend: { display: false }
                }
            }
        });

        // Utilization Trend Chart
        const utilizationCtx = document.getElementById('utilizationTrendChart').getContext('2d');
        new Chart(utilizationCtx, {
            type: 'line',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                datasets: [{
                    label: 'Utilization %',
                    data: [82, 85, 88, 92],
                    borderColor: '#8b5cf6',
                    backgroundColor: 'rgba(139, 92, 246, 0.1)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true, max: 100 }
                },
                plugins: {
                    legend: { display: false }
                }
            }
        });

        // Overtime Chart
        const overtimeCtx = document.getElementById('overtimeChart').getContext('2d');
        new Chart(overtimeCtx, {
            type: 'bar',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                datasets: [{
                    label: 'Overtime Hours',
                    data: [2, 4.5, 1, 1],
                    backgroundColor: ['#f59e0b', '#ef4444', '#f59e0b', '#f59e0b']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true }
                },
                plugins: {
                    legend: { display: false }
                }
            }
        });

        // Planned vs Actual Chart
        const plannedActualCtx = document.getElementById('plannedVsActualChart').getContext('2d');
        new Chart(plannedActualCtx, {
            type: 'bar',
            data: {
                labels: ['Website Redesign', 'Mobile App', 'Cloud Migration', 'Data Analytics', 'CRM Implementation'],
                datasets: [
                    {
                        label: 'Planned',
                        data: [70, 45, 25, 15, 5],
                        backgroundColor: '#3b82f6'
                    },
                    {
                        label: 'Actual',
                        data: [75.8, 47.2, 25.3, 16.2, 4],
                        backgroundColor: '#10b981'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true }
                },
                plugins: {
                    legend: { position: 'bottom' }
                }
            }
        });

        // Generate Heat Map
        function generateHeatMap() {
            const hours = ['9 AM', '10 AM', '11 AM', '12 PM', '1 PM', '2 PM', '3 PM', '4 PM', '5 PM', '6 PM'];
            const heatData = [
                [2, 3, 4, 3, 2, 0, 0],
                [4, 4, 5, 4, 3, 0, 0],
                [3, 4, 4, 5, 4, 0, 0],
                [2, 3, 3, 2, 2, 0, 0],
                [1, 2, 2, 2, 1, 0, 0],
                [3, 4, 4, 3, 3, 0, 0],
                [4, 5, 5, 4, 4, 0, 0],
                [3, 4, 4, 3, 3, 0, 0],
                [2, 2, 3, 2, 2, 0, 0],
                [1, 1, 1, 1, 1, 0, 0]
            ];

            const tbody = document.getElementById('heatMapBody');
            hours.forEach((hour, i) => {
                const row = document.createElement('tr');
                row.innerHTML = `<td class="py-2 px-3 text-sm text-gray-600">${hour}</td>`;
                
                heatData[i].forEach(value => {
                    const cell = document.createElement('td');
                    cell.className = 'text-center py-2 px-3';
                    const intensity = value === 0 ? 'bg-gray-100' : 
                                    value === 1 ? 'bg-blue-200' :
                                    value === 2 ? 'bg-blue-300' :
                                    value === 3 ? 'bg-blue-400' :
                                    value === 4 ? 'bg-blue-600' : 'bg-blue-800';
                    cell.innerHTML = `<div class="heat-cell w-8 h-8 ${intensity} rounded mx-auto" title="${value}h logged"></div>`;
                    row.appendChild(cell);
                });
                
                tbody.appendChild(row);
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            generateHeatMap();
            showToast('Analytics loaded successfully');
        });
    </script>
</body>
</html>