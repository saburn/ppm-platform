<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Project Planning - World Class PPM</title>
    
    <!-- Professional Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- D3.js for Professional Charts -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
    <!-- Custom Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s ease-in-out infinite',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'fade-in': 'fadeIn 0.5s ease-out',
                        'scale-in': 'scaleIn 0.2s ease-out',
                    },
                    colors: {
                        'executive': {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Glass Morphism Effects */
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .glass-dark {
            background: rgba(30, 58, 138, 0.3);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Gradient Backgrounds */
        .executive-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .chart-gradient {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        /* Drag and Drop Styles */
        .draggable {
            cursor: move;
            transition: all 0.3s ease;
        }
        
        .draggable:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .dragging {
            opacity: 0.5;
            transform: scale(1.05);
            z-index: 1000;
        }
        
        .drop-zone {
            min-height: 60px;
            border: 2px dashed transparent;
            transition: all 0.3s ease;
        }
        
        .drop-zone.drag-over {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }
        
        /* Professional Chart Styles */
        .chart-container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        
        /* Gantt Chart Styles */
        .gantt-bar {
            cursor: move;
            transition: all 0.2s ease;
            border-radius: 4px;
        }
        
        .gantt-bar:hover {
            filter: brightness(1.1);
            transform: scaleY(1.1);
        }
        
        /* Micro-interactions */
        .micro-hover {
            transition: all 0.2s ease;
        }
        
        .micro-hover:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Loading Animation */
        .loading-dots span {
            animation: loading 1.4s infinite ease-in-out both;
        }
        
        .loading-dots span:nth-child(1) {
            animation-delay: -0.32s;
        }
        
        .loading-dots span:nth-child(2) {
            animation-delay: -0.16s;
        }
        
        @keyframes loading {
            0%, 80%, 100% {
                transform: scale(0);
            }
            40% {
                transform: scale(1);
            }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes scaleIn {
            from {
                transform: scale(0.9);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body class="bg-gray-50">
    
    <!-- Executive Header -->
    <header class="executive-gradient text-white p-6 shadow-2xl">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <div class="glass-dark p-3 rounded-xl">
                    <i class="fas fa-project-diagram text-2xl"></i>
                </div>
                <div>
                    <h1 class="text-3xl font-bold">Executive Project Planning</h1>
                    <p class="text-blue-100 text-sm">World-Class Project Management Platform</p>
                </div>
            </div>
            <div class="flex items-center space-x-6">
                <div class="text-right">
                    <div class="text-sm text-blue-100">Current Project</div>
                    <div class="font-semibold">Website Redesign</div>
                </div>
                <div class="glass-dark p-3 rounded-xl">
                    <i class="fas fa-user-tie text-xl"></i>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="max-w-7xl mx-auto p-6">
        
        <!-- Executive KPI Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="glass-dark rounded-2xl p-6 text-white micro-hover animate-scale-in">
                <div class="flex items-center justify-between mb-4">
                    <div class="glass p-3 rounded-lg">
                        <i class="fas fa-tasks text-xl"></i>
                    </div>
                    <span class="text-2xl font-bold">42</span>
                </div>
                <div class="text-sm text-blue-100">Total Tasks</div>
                <div class="mt-2 text-xs text-green-300">
                    <i class="fas fa-arrow-up"></i> 12% this week
                </div>
            </div>
            
            <div class="glass-dark rounded-2xl p-6 text-white micro-hover animate-scale-in" style="animation-delay: 0.1s">
                <div class="flex items-center justify-between mb-4">
                    <div class="glass p-3 rounded-lg">
                        <i class="fas fa-chart-line text-xl"></i>
                    </div>
                    <span class="text-2xl font-bold">78%</span>
                </div>
                <div class="text-sm text-blue-100">Progress</div>
                <div class="mt-2 text-xs text-green-300">
                    <i class="fas fa-arrow-up"></i> On track
                </div>
            </div>
            
            <div class="glass-dark rounded-2xl p-6 text-white micro-hover animate-scale-in" style="animation-delay: 0.2s">
                <div class="flex items-center justify-between mb-4">
                    <div class="glass p-3 rounded-lg">
                        <i class="fas fa-users text-xl"></i>
                    </div>
                    <span class="text-2xl font-bold">8</span>
                </div>
                <div class="text-sm text-blue-100">Team Members</div>
                <div class="mt-2 text-xs text-yellow-300">
                    <i class="fas fa-minus"></i> 87% utilized
                </div>
            </div>
            
            <div class="glass-dark rounded-2xl p-6 text-white micro-hover animate-scale-in" style="animation-delay: 0.3s">
                <div class="flex items-center justify-between mb-4">
                    <div class="glass p-3 rounded-lg">
                        <i class="fas fa-dollar-sign text-xl"></i>
                    </div>
                    <span class="text-2xl font-bold">$250K</span>
                </div>
                <div class="text-sm text-blue-100">Budget</div>
                <div class="mt-2 text-xs text-green-300">
                    <i class="fas fa-arrow-down"></i> Under by 8%
                </div>
            </div>
        </div>

        <!-- Revolutionary Tab Navigation -->
        <div class="glass rounded-2xl p-2 mb-8 animate-fade-in">
            <div class="flex space-x-2">
                <button onclick="switchTab('gantt')" class="tab-btn flex-1 px-6 py-3 rounded-xl text-white font-semibold transition-all duration-300 executive-gradient" data-tab="gantt">
                    <i class="fas fa-chart-gantt mr-2"></i>Interactive Gantt
                </button>
                <button onclick="switchTab('tasks')" class="tab-btn flex-1 px-6 py-3 rounded-xl text-gray-700 hover:bg-gray-100 font-semibold transition-all duration-300" data-tab="tasks">
                    <i class="fas fa-tasks mr-2"></i>Task Board
                </button>
                <button onclick="switchTab('milestones')" class="tab-btn flex-1 px-6 py-3 rounded-xl text-gray-700 hover:bg-gray-100 font-semibold transition-all duration-300" data-tab="milestones">
                    <i class="fas fa-flag mr-2"></i>Milestones
                </button>
                <button onclick="switchTab('resources')" class="tab-btn flex-1 px-6 py-3 rounded-xl text-gray-700 hover:bg-gray-100 font-semibold transition-all duration-300" data-tab="resources">
                    <i class="fas fa-users mr-2"></i>Resources
                </button>
                <button onclick="switchTab('analytics')" class="tab-btn flex-1 px-6 py-3 rounded-xl text-gray-700 hover:bg-gray-100 font-semibold transition-all duration-300" data-tab="analytics">
                    <i class="fas fa-chart-pie mr-2"></i>Analytics
                </button>
            </div>
        </div>

        <!-- Tab Content Container -->
        <div class="bg-white rounded-2xl shadow-xl p-8 animate-slide-up">
            
            <!-- GANTT CHART TAB -->
            <div id="gantt-tab" class="tab-content">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">
                        <i class="fas fa-chart-gantt text-executive-600 mr-3"></i>
                        Interactive Gantt Chart
                    </h2>
                    <div class="flex space-x-3">
                        <button onclick="zoomGantt('in')" class="px-4 py-2 bg-executive-100 text-executive-700 rounded-lg hover:bg-executive-200 transition-colors">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button onclick="zoomGantt('out')" class="px-4 py-2 bg-executive-100 text-executive-700 rounded-lg hover:bg-executive-200 transition-colors">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button onclick="addNewTask()" class="px-4 py-2 executive-gradient text-white rounded-lg hover:opacity-90 transition-opacity">
                            <i class="fas fa-plus mr-2"></i>Add Task
                        </button>
                    </div>
                </div>
                
                <!-- Professional Gantt Chart -->
                <div class="chart-container">
                    <div id="gantt-chart" class="custom-scrollbar overflow-x-auto" style="height: 400px;">
                        <!-- Gantt chart will be rendered here -->
                    </div>
                </div>
                
                <!-- Gantt Legend -->
                <div class="mt-6 flex items-center justify-center space-x-8">
                    <div class="flex items-center">
                        <div class="w-4 h-4 bg-green-500 rounded mr-2"></div>
                        <span class="text-sm text-gray-600">Complete</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-4 h-4 bg-blue-500 rounded mr-2"></div>
                        <span class="text-sm text-gray-600">In Progress</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-4 h-4 bg-yellow-500 rounded mr-2"></div>
                        <span class="text-sm text-gray-600">At Risk</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-4 h-4 bg-red-500 rounded mr-2"></div>
                        <span class="text-sm text-gray-600">Overdue</span>
                    </div>
                </div>
            </div>

            <!-- TASK BOARD TAB -->
            <div id="tasks-tab" class="tab-content hidden">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">
                        <i class="fas fa-tasks text-executive-600 mr-3"></i>
                        Interactive Task Board
                    </h2>
                    <button onclick="addNewTaskBoard()" class="px-4 py-2 executive-gradient text-white rounded-lg hover:opacity-90 transition-opacity">
                        <i class="fas fa-plus mr-2"></i>Add Task
                    </button>
                </div>
                
                <!-- Kanban-style Task Board -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="bg-gray-50 rounded-xl p-4">
                        <h3 class="font-semibold text-gray-700 mb-4">To Do</h3>
                        <div id="todo-column" class="drop-zone space-y-3 min-h-[200px]">
                            <!-- Tasks will be added here -->
                        </div>
                    </div>
                    <div class="bg-blue-50 rounded-xl p-4">
                        <h3 class="font-semibold text-blue-700 mb-4">In Progress</h3>
                        <div id="progress-column" class="drop-zone space-y-3 min-h-[200px]">
                            <!-- Tasks will be added here -->
                        </div>
                    </div>
                    <div class="bg-yellow-50 rounded-xl p-4">
                        <h3 class="font-semibold text-yellow-700 mb-4">Review</h3>
                        <div id="review-column" class="drop-zone space-y-3 min-h-[200px]">
                            <!-- Tasks will be added here -->
                        </div>
                    </div>
                    <div class="bg-green-50 rounded-xl p-4">
                        <h3 class="font-semibold text-green-700 mb-4">Done</h3>
                        <div id="done-column" class="drop-zone space-y-3 min-h-[200px]">
                            <!-- Tasks will be added here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- MILESTONES TAB -->
            <div id="milestones-tab" class="tab-content hidden">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">
                        <i class="fas fa-flag text-executive-600 mr-3"></i>
                        Project Milestones
                    </h2>
                    <button onclick="addNewMilestone()" class="px-4 py-2 executive-gradient text-white rounded-lg hover:opacity-90 transition-opacity">
                        <i class="fas fa-plus mr-2"></i>Add Milestone
                    </button>
                </div>
                
                <!-- Timeline Milestones -->
                <div id="milestones-timeline" class="relative">
                    <!-- Milestones will be rendered here -->
                </div>
            </div>

            <!-- RESOURCES TAB -->
            <div id="resources-tab" class="tab-content hidden">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">
                        <i class="fas fa-users text-executive-600 mr-3"></i>
                        Resource Allocation
                    </h2>
                    <div class="flex space-x-3">
                        <button onclick="optimizeResources()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                            <i class="fas fa-magic mr-2"></i>AI Optimize
                        </button>
                        <button onclick="addResource()" class="px-4 py-2 executive-gradient text-white rounded-lg hover:opacity-90 transition-opacity">
                            <i class="fas fa-plus mr-2"></i>Add Resource
                        </button>
                    </div>
                </div>
                
                <!-- Resource Chart -->
                <div class="chart-container">
                    <div id="resource-chart" style="height: 400px;">
                        <!-- Resource chart will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- ANALYTICS TAB -->
            <div id="analytics-tab" class="tab-content hidden">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">
                        <i class="fas fa-chart-pie text-executive-600 mr-3"></i>
                        Project Analytics
                    </h2>
                    <button onclick="refreshAnalytics()" class="px-4 py-2 executive-gradient text-white rounded-lg hover:opacity-90 transition-opacity">
                        <i class="fas fa-sync mr-2"></i>Refresh
                    </button>
                </div>
                
                <!-- Analytics Dashboard -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="chart-container">
                        <h3 class="font-semibold text-gray-700 mb-4">Task Status Distribution</h3>
                        <div id="status-chart" style="height: 300px;">
                            <!-- Status chart will be rendered here -->
                        </div>
                    </div>
                    <div class="chart-container">
                        <h3 class="font-semibold text-gray-700 mb-4">Budget Utilization</h3>
                        <div id="budget-chart" style="height: 300px;">
                            <!-- Budget chart will be rendered here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- Executive JavaScript -->
    <script>
        // Project Data
        let projectData = {
            tasks: [
                { id: 1, name: 'Requirements Analysis', start: '2024-01-01', end: '2024-01-15', status: 'complete', progress: 100, assignee: 'John Smith', dependencies: [] },
                { id: 2, name: 'UI/UX Design', start: '2024-01-10', end: '2024-01-25', status: 'complete', progress: 100, assignee: 'Sarah Johnson', dependencies: [1] },
                { id: 3, name: 'Frontend Development', start: '2024-01-20', end: '2024-02-10', status: 'in-progress', progress: 75, assignee: 'Mike Wilson', dependencies: [2] },
                { id: 4, name: 'Backend Development', start: '2024-01-25', end: '2024-02-15', status: 'in-progress', progress: 60, assignee: 'Emily Chen', dependencies: [2] },
                { id: 5, name: 'Database Setup', start: '2024-01-15', end: '2024-01-30', status: 'complete', progress: 100, assignee: 'David Lee', dependencies: [1] },
                { id: 6, name: 'API Integration', start: '2024-02-05', end: '2024-02-20', status: 'at-risk', progress: 30, assignee: 'Alex Kumar', dependencies: [3, 4] },
                { id: 7, name: 'Testing Phase', start: '2024-02-15', end: '2024-02-28', status: 'todo', progress: 0, assignee: 'Lisa Wang', dependencies: [6] },
                { id: 8, name: 'Deployment', start: '2024-03-01', end: '2024-03-05', status: 'todo', progress: 0, assignee: 'Tom Brown', dependencies: [7] }
            ],
            milestones: [
                { id: 1, name: 'Design Complete', date: '2024-01-25', status: 'completed' },
                { id: 2, name: 'Development Milestone', date: '2024-02-15', status: 'upcoming' },
                { id: 3, name: 'Testing Complete', date: '2024-02-28', status: 'upcoming' },
                { id: 4, name: 'Project Launch', date: '2024-03-05', status: 'upcoming' }
            ],
            resources: [
                { name: 'John Smith', role: 'Project Manager', utilization: 85, capacity: 160, assigned: 136 },
                { name: 'Sarah Johnson', role: 'UI/UX Designer', utilization: 92, capacity: 160, assigned: 147 },
                { name: 'Mike Wilson', role: 'Frontend Developer', utilization: 78, capacity: 160, assigned: 125 },
                { name: 'Emily Chen', role: 'Backend Developer', utilization: 85, capacity: 160, assigned: 136 },
                { name: 'David Lee', role: 'Database Admin', utilization: 70, capacity: 160, assigned: 112 },
                { name: 'Alex Kumar', role: 'API Specialist', utilization: 65, capacity: 160, assigned: 104 },
                { name: 'Lisa Wang', role: 'QA Engineer', utilization: 60, capacity: 160, assigned: 96 },
                { name: 'Tom Brown', role: 'DevOps Engineer', utilization: 55, capacity: 160, assigned: 88 }
            ]
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeGanttChart();
            initializeTaskBoard();
            initializeMilestones();
            initializeResources();
            initializeAnalytics();
            setupDragAndDrop();
        });

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.remove('hidden');
            
            // Update button styles
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('executive-gradient', 'text-white');
                btn.classList.add('text-gray-700', 'hover:bg-gray-100');
            });
            
            // Activate selected button
            const activeBtn = document.querySelector(`[data-tab="${tabName}"]`);
            activeBtn.classList.remove('text-gray-700', 'hover:bg-gray-100');
            activeBtn.classList.add('executive-gradient', 'text-white');
            
            // Refresh charts when switching tabs
            if (tabName === 'gantt') refreshGanttChart();
            if (tabName === 'resources') refreshResourceChart();
            if (tabName === 'analytics') refreshAnalytics();
        }

        // Gantt Chart Functions
        function initializeGanttChart() {
            renderGanttChart();
        }

        function renderGanttChart() {
            const container = document.getElementById('gantt-chart');
            const width = 1200;
            const height = 350;
            const margin = { top: 20, right: 30, bottom: 40, left: 150 };
            
            // Clear existing chart
            container.innerHTML = '';
            
            // Create SVG
            const svg = d3.select('#gantt-chart')
                .append('svg')
                .attr('width', width)
                .attr('height', height);
            
            // Create scales
            const xScale = d3.scaleTime()
                .domain([new Date('2024-01-01'), new Date('2024-03-10')])
                .range([margin.left, width - margin.right]);
            
            const yScale = d3.scaleBand()
                .domain(projectData.tasks.map(d => d.name))
                .range([margin.top, height - margin.bottom])
                .padding(0.2);
            
            // Create task groups
            const taskGroups = svg.selectAll('.task-group')
                .data(projectData.tasks)
                .enter()
                .append('g')
                .attr('class', 'task-group');
            
            // Add task bars
            taskGroups.append('rect')
                .attr('class', 'gantt-bar draggable')
                .attr('x', d => xScale(new Date(d.start)))
                .attr('y', d => yScale(d.name))
                .attr('width', d => xScale(new Date(d.end)) - xScale(new Date(d.start)))
                .attr('height', yScale.bandwidth())
                .attr('fill', d => {
                    switch(d.status) {
                        case 'complete': return '#10b981';
                        case 'in-progress': return '#3b82f6';
                        case 'at-risk': return '#f59e0b';
                        case 'todo': return '#6b7280';
                        default: return '#6b7280';
                    }
                })
                .attr('rx', 4)
                .style('cursor', 'move')
                .on('click', function(event, d) {
                    showToast(`Task: ${d.name} - Progress: ${d.progress}%`, 'info');
                });
            
            // Add progress bars
            taskGroups.append('rect')
                .attr('x', d => xScale(new Date(d.start)))
                .attr('y', d => yScale(d.name))
                .attr('width', d => (xScale(new Date(d.end)) - xScale(new Date(d.start))) * (d.progress / 100))
                .attr('height', yScale.bandwidth())
                .attr('fill', 'rgba(255, 255, 255, 0.3)')
                .attr('rx', 4);
            
            // Add task labels
            taskGroups.append('text')
                .attr('x', 10)
                .attr('y', d => yScale(d.name) + yScale.bandwidth() / 2)
                .attr('dy', '0.35em')
                .text(d => d.name)
                .style('font-size', '12px')
                .style('fill', '#374151');
            
            // Add grid lines
            svg.append('g')
                .attr('class', 'grid')
                .attr('transform', `translate(0,${height - margin.bottom})`)
                .call(d3.axisBottom(xScale)
                    .tickSize(-height + margin.top + margin.bottom)
                    .tickFormat('')
                )
                .style('stroke-dasharray', '3,3')
                .style('opacity', 0.3);
            
            // Add x-axis
            svg.append('g')
                .attr('transform', `translate(0,${height - margin.bottom})`)
                .call(d3.axisBottom(xScale).tickFormat(d3.timeFormat('%b %d')));
            
            // Setup drag and drop for Gantt bars
            setupGanttDragDrop();
        }

        function setupGanttDragDrop() {
            const dragHandler = d3.drag()
                .on('start', function(event, d) {
                    d3.select(this).classed('dragging', true);
                })
                .on('drag', function(event, d) {
                    const xScale = d3.scaleTime()
                        .domain([new Date('2024-01-01'), new Date('2024-03-10')])
                        .range([150, 1170]);
                    
                    const newX = Math.max(150, Math.min(1170 - 100, event.x));
                    const newStartDate = xScale.invert(newX);
                    const duration = new Date(d.end) - new Date(d.start);
                    const newEndDate = new Date(newStartDate.getTime() + duration);
                    
                    d3.select(this)
                        .attr('x', newX);
                    
                    // Update progress bar
                    const progressRect = d3.select(this).next();
                    progressRect.attr('x', newX);
                })
                .on('end', function(event, d) {
                    d3.select(this).classed('dragging', false);
                    showToast('Task rescheduled successfully!', 'success');
                });
            
            d3.selectAll('.gantt-bar').call(dragHandler);
        }

        // Task Board Functions
        function initializeTaskBoard() {
            const tasks = projectData.tasks;
            
            tasks.forEach(task => {
                const taskCard = createTaskCard(task);
                const column = getColumnByStatus(task.status);
                if (column) {
                    column.appendChild(taskCard);
                }
            });
        }

        function createTaskCard(task) {
            const card = document.createElement('div');
            card.className = 'bg-white p-4 rounded-lg shadow-sm border border-gray-200 draggable cursor-move';
            card.draggable = true;
            card.dataset.taskId = task.id;
            
            card.innerHTML = `
                <div class="flex items-center justify-between mb-2">
                    <span class="text-xs px-2 py-1 rounded-full ${getStatusColor(task.status)}">
                        ${task.status}
                    </span>
                    <button onclick="editTask(${task.id})" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-edit text-xs"></i>
                    </button>
                </div>
                <h4 class="font-semibold text-gray-800 mb-2">${task.name}</h4>
                <div class="flex items-center justify-between text-xs text-gray-500">
                    <span><i class="fas fa-user mr-1"></i>${task.assignee}</span>
                    <span>${task.progress}%</span>
                </div>
                <div class="mt-2 bg-gray-200 rounded-full h-2">
                    <div class="bg-blue-600 h-2 rounded-full" style="width: ${task.progress}%"></div>
                </div>
            `;
            
            return card;
        }

        function getColumnByStatus(status) {
            switch(status) {
                case 'todo': return document.getElementById('todo-column');
                case 'in-progress': return document.getElementById('progress-column');
                case 'at-risk': 
                case 'review': return document.getElementById('review-column');
                case 'complete': return document.getElementById('done-column');
                default: return document.getElementById('todo-column');
            }
        }

        function getStatusColor(status) {
            switch(status) {
                case 'todo': return 'bg-gray-100 text-gray-600';
                case 'in-progress': return 'bg-blue-100 text-blue-600';
                case 'at-risk': return 'bg-yellow-100 text-yellow-600';
                case 'review': return 'bg-purple-100 text-purple-600';
                case 'complete': return 'bg-green-100 text-green-600';
                default: return 'bg-gray-100 text-gray-600';
            }
        }

        // Milestone Functions
        function initializeMilestones() {
            renderMilestones();
        }

        function renderMilestones() {
            const container = document.getElementById('milestones-timeline');
            container.innerHTML = '';
            
            const timeline = document.createElement('div');
            timeline.className = 'relative';
            
            // Create timeline line
            const line = document.createElement('div');
            line.className = 'absolute left-8 top-0 bottom-0 w-0.5 bg-gray-300';
            timeline.appendChild(line);
            
            // Add milestones
            projectData.milestones.forEach((milestone, index) => {
                const milestoneEl = document.createElement('div');
                milestoneEl.className = 'relative flex items-center mb-8 draggable';
                milestoneEl.draggable = true;
                milestoneEl.dataset.milestoneId = milestone.id;
                
                milestoneEl.innerHTML = `
                    <div class="absolute left-6 w-5 h-5 bg-white border-4 ${milestone.status === 'completed' ? 'border-green-500' : 'border-blue-500'} rounded-full z-10"></div>
                    <div class="ml-16 glass rounded-lg p-6 flex-1">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-bold text-lg text-gray-800">${milestone.name}</h3>
                            <span class="text-sm text-gray-500">${milestone.date}</span>
                        </div>
                        <div class="flex items-center space-x-4">
                            <span class="px-3 py-1 rounded-full text-xs font-semibold ${milestone.status === 'completed' ? 'bg-green-100 text-green-600' : 'bg-blue-100 text-blue-600'}">
                                ${milestone.status}
                            </span>
                        </div>
                    </div>
                `;
                
                timeline.appendChild(milestoneEl);
            });
            
            container.appendChild(timeline);
        }

        // Resource Chart Functions
        function initializeResources() {
            renderResourceChart();
        }

        function renderResourceChart() {
            const container = document.getElementById('resource-chart');
            const width = container.offsetWidth;
            const height = 400;
            const margin = { top: 20, right: 30, bottom: 60, left: 100 };
            
            // Clear existing chart
            container.innerHTML = '';
            
            // Create SVG
            const svg = d3.select('#resource-chart')
                .append('svg')
                .attr('width', width)
                .attr('height', height);
            
            // Create scales
            const xScale = d3.scaleLinear()
                .domain([0, 100])
                .range([margin.left, width - margin.right]);
            
            const yScale = d3.scaleBand()
                .domain(projectData.resources.map(d => d.name))
                .range([margin.top, height - margin.bottom])
                .padding(0.2);
            
            // Create resource bars
            svg.selectAll('.resource-bar')
                .data(projectData.resources)
                .enter()
                .append('rect')
                .attr('class', 'resource-bar')
                .attr('x', margin.left)
                .attr('y', d => yScale(d.name))
                .attr('width', d => xScale(d.utilization))
                .attr('height', yScale.bandwidth())
                .attr('fill', d => {
                    if (d.utilization > 90) return '#ef4444';
                    if (d.utilization > 75) return '#f59e0b';
                    return '#10b981';
                })
                .attr('rx', 4);
            
            // Add labels
            svg.selectAll('.resource-label')
                .data(projectData.resources)
                .enter()
                .append('text')
                .attr('x', margin.left - 10)
                .attr('y', d => yScale(d.name) + yScale.bandwidth() / 2)
                .attr('dy', '0.35em')
                .text(d => `${d.name} (${d.utilization}%)`)
                .style('font-size', '12px')
                .style('text-anchor', 'end')
                .style('fill', '#374151');
            
            // Add x-axis
            svg.append('g')
                .attr('transform', `translate(0,${height - margin.bottom})`)
                .call(d3.axisBottom(xScale));
        }

        // Analytics Functions
        function initializeAnalytics() {
            renderStatusChart();
            renderBudgetChart();
        }

        function renderStatusChart() {
            const container = document.getElementById('status-chart');
            container.innerHTML = '';
            
            const statusCounts = {
                'complete': projectData.tasks.filter(t => t.status === 'complete').length,
                'in-progress': projectData.tasks.filter(t => t.status === 'in-progress').length,
                'at-risk': projectData.tasks.filter(t => t.status === 'at-risk').length,
                'todo': projectData.tasks.filter(t => t.status === 'todo').length
            };
            
            const data = Object.entries(statusCounts).map(([status, count]) => ({
                status,
                count,
                percentage: Math.round((count / projectData.tasks.length) * 100)
            }));
            
            const width = container.offsetWidth;
            const height = 300;
            const radius = Math.min(width, height) / 2 - 20;
            
            const svg = d3.select('#status-chart')
                .append('svg')
                .attr('width', width)
                .attr('height', height)
                .append('g')
                .attr('transform', `translate(${width/2},${height/2})`);
            
            const color = d3.scaleOrdinal()
                .domain(['complete', 'in-progress', 'at-risk', 'todo'])
                .range(['#10b981', '#3b82f6', '#f59e0b', '#6b7280']);
            
            const pie = d3.pie()
                .value(d => d.count);
            
            const arc = d3.arc()
                .innerRadius(0)
                .outerRadius(radius);
            
            const arcs = svg.selectAll('.arc')
                .data(pie(data))
                .enter()
                .append('g')
                .attr('class', 'arc');
            
            arcs.append('path')
                .attr('d', arc)
                .attr('fill', d => color(d.data.status))
                .attr('stroke', 'white')
                .attr('stroke-width', 2);
            
            arcs.append('text')
                .attr('transform', d => `translate(${arc.centroid(d)})`)
                .attr('dy', '0.35em')
                .style('text-anchor', 'middle')
                .style('font-size', '12px')
                .style('fill', 'white')
                .style('font-weight', 'bold')
                .text(d => `${d.data.percentage}%`);
        }

        function renderBudgetChart() {
            const container = document.getElementById('budget-chart');
            container.innerHTML = '';
            
            const data = [
                { category: 'Development', budget: 150000, spent: 120000 },
                { category: 'Design', budget: 50000, spent: 45000 },
                { category: 'Infrastructure', budget: 30000, spent: 25000 },
                { category: 'Marketing', budget: 20000, spent: 15000 }
            ];
            
            const width = container.offsetWidth;
            const height = 300;
            const margin = { top: 20, right: 30, bottom: 60, left: 60 };
            
            const svg = d3.select('#budget-chart')
                .append('svg')
                .attr('width', width)
                .attr('height', height);
            
            const xScale = d3.scaleBand()
                .domain(data.map(d => d.category))
                .range([margin.left, width - margin.right])
                .padding(0.2);
            
            const yScale = d3.scaleLinear()
                .domain([0, d3.max(data, d => d.budget)])
                .range([height - margin.bottom, margin.top]);
            
            // Budget bars
            svg.selectAll('.budget-bar')
                .data(data)
                .enter()
                .append('rect')
                .attr('class', 'budget-bar')
                .attr('x', d => xScale(d.category))
                .attr('y', d => yScale(d.budget))
                .attr('width', xScale.bandwidth() / 2 - 2)
                .attr('height', d => height - margin.bottom - yScale(d.budget))
                .attr('fill', '#e5e7eb')
                .attr('rx', 4);
            
            // Spent bars
            svg.selectAll('.spent-bar')
                .data(data)
                .enter()
                .append('rect')
                .attr('class', 'spent-bar')
                .attr('x', d => xScale(d.category) + xScale.bandwidth() / 2)
                .attr('y', d => yScale(d.spent))
                .attr('width', xScale.bandwidth() / 2 - 2)
                .attr('height', d => height - margin.bottom - yScale(d.spent))
                .attr('fill', '#3b82f6')
                .attr('rx', 4);
            
            // Axes
            svg.append('g')
                .attr('transform', `translate(0,${height - margin.bottom})`)
                .call(d3.axisBottom(xScale));
            
            svg.append('g')
                .attr('transform', `translate(${margin.left},0)`)
                .call(d3.axisLeft(yScale).tickFormat(d => `$${(d/1000).toFixed(0)}K`));
        }

        // Drag and Drop Setup
        function setupDragAndDrop() {
            // Task board drag and drop
            const taskCards = document.querySelectorAll('#tasks-tab .draggable');
            const dropZones = document.querySelectorAll('.drop-zone');
            
            taskCards.forEach(card => {
                card.addEventListener('dragstart', handleDragStart);
                card.addEventListener('dragend', handleDragEnd);
            });
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('drop', handleDrop);
                zone.addEventListener('dragleave', handleDragLeave);
            });
        }

        let draggedElement = null;

        function handleDragStart(e) {
            draggedElement = e.target;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            draggedElement = null;
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            e.currentTarget.classList.add('drag-over');
            return false;
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            
            e.currentTarget.classList.remove('drag-over');
            
            if (draggedElement && e.currentTarget.classList.contains('drop-zone')) {
                e.currentTarget.appendChild(draggedElement);
                showToast('Task moved successfully!', 'success');
            }
            
            return false;
        }

        // Utility Functions
        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            
            const bgColor = type === 'success' ? 'bg-green-500' : 
                           type === 'error' ? 'bg-red-500' : 
                           type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500';
            
            toast.className = `${bgColor} text-white px-6 py-3 rounded-lg shadow-lg transform transition-all duration-300 translate-x-full`;
            toast.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            container.appendChild(toast);
            
            // Animate in
            setTimeout(() => {
                toast.classList.remove('translate-x-full');
                toast.classList.add('translate-x-0');
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                toast.classList.add('translate-x-full');
                setTimeout(() => {
                    container.removeChild(toast);
                }, 300);
            }, 3000);
        }

        // Action Functions
        function addNewTask() {
            showToast('Add new task functionality coming soon!', 'info');
        }

        function addNewTaskBoard() {
            showToast('Add new task to board coming soon!', 'info');
        }

        function addNewMilestone() {
            showToast('Add new milestone coming soon!', 'info');
        }

        function addResource() {
            showToast('Add new resource coming soon!', 'info');
        }

        function editTask(taskId) {
            showToast(`Edit task ${taskId} coming soon!`, 'info');
        }

        function zoomGantt(direction) {
            showToast(`Gantt chart ${direction === 'in' ? 'zoomed in' : 'zoomed out'}!`, 'info');
        }

        function optimizeResources() {
            showToast('AI resource optimization in progress...', 'info');
            setTimeout(() => {
                showToast('Resources optimized! Efficiency improved by 15%', 'success');
            }, 2000);
        }

        function refreshAnalytics() {
            showToast('Analytics refreshed with latest data!', 'success');
            renderStatusChart();
            renderBudgetChart();
        }

        function refreshGanttChart() {
            renderGanttChart();
        }

        function refreshResourceChart() {
            renderResourceChart();
        }
    </script>
</body>
</html>